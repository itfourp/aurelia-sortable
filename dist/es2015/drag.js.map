{"version":3,"sources":["../../src/drag.js"],"names":["transient","Drag","startLeft","startTop","rect","left","top","width","height","offsetX","offsetY","pin","item","sortingClass","clone","element","cloneNode","style","position","pointerEvents","margin","zIndex","dragZIndex","document","body","appendChild","unpin","removeChild","getCenterX","getCenterY","start","x","y","viewportScroll","scrollLeft","scrollTop","axis","minPosX","maxPosX","minPosY","maxPosY","getBoundingClientRect","update","end"],"mappings":"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","file":"drag.js","sourcesContent":["import {transient} from \"aurelia-dependency-injection\";\r\n\r\n@transient()\r\nexport class Drag {\r\n  startLeft = 0;\r\n  startTop = 0;\r\n  rect = { left: 0, top: 0, width: 0, height: 0 };\r\n  offsetX = 0;\r\n  offsetY = 0;\r\n\r\n  pin() {\r\n    this.item.sortingClass = this.sortingClass;\r\n    this.clone = this.element.cloneNode(true);\r\n    this.clone.style.position = \"absolute\";\r\n    this.clone.style.width = this.rect.width + \"px\";\r\n    this.clone.style.height = this.rect.height + \"px\";\r\n    this.clone.style.pointerEvents = \"none\";\r\n    this.clone.style.margin = 0;\r\n    this.clone.style.zIndex = this.dragZIndex;\r\n    document.body.appendChild(this.clone);\r\n  }\r\n  unpin() {\r\n    this.item.sortingClass = \"\";\r\n    document.body.removeChild(this.clone);\r\n    this.clone = null;\r\n  }\r\n  getCenterX() {\r\n    return this.rect.left + this.rect.width / 2;\r\n  }\r\n  getCenterY() {\r\n    return this.rect.top + this.rect.height / 2;\r\n  }\r\n  start(element, item, x, y, viewportScroll, scrollLeft, scrollTop, dragZIndex, axis, sortingClass, minPosX, maxPosX, minPosY, maxPosY) {\r\n    this.element = element;\r\n    this.item = item;\r\n    this.sortingClass = sortingClass;\r\n    this.dragZIndex = dragZIndex;\r\n    const rect = (this.rect = element.getBoundingClientRect());\r\n\r\n    this.startLeft = rect.left;\r\n    this.startTop = rect.top;\r\n\r\n    this.offsetX = this.startLeft - x;\r\n    this.offsetY = this.startTop - y;\r\n\r\n    this.pin();\r\n\r\n    this.update(x, y, viewportScroll, scrollLeft, scrollTop, axis, minPosX, maxPosX, minPosY, maxPosY);\r\n  }\r\n  update(x, y, viewportScroll, scrollLeft, scrollTop, axis, minPosX, maxPosX, minPosY, maxPosY) {\r\n    x += this.offsetX;\r\n    y += this.offsetY;\r\n    if (viewportScroll) {\r\n      x += scrollLeft;\r\n      y += scrollTop;\r\n    }\r\n\r\n    if (x < minPosX) {\r\n      x = minPosX;\r\n    }\r\n    if (x > maxPosX - this.rect.width) {\r\n      x = maxPosX - this.rect.width;\r\n    }\r\n\r\n    if (y < minPosY) {\r\n      y = minPosY;\r\n    }\r\n    if (y > maxPosY - this.rect.height) {\r\n      y = maxPosY - this.rect.height;\r\n    }\r\n\r\n    switch (axis) {\r\n    case \"x\":\r\n      y = this.startTop;\r\n      break;\r\n    case \"y\":\r\n      x = this.startLeft;\r\n      break;\r\n    }\r\n\r\n    this.clone.style.left = x + \"px\";\r\n    this.clone.style.top = y + \"px\";\r\n  }\r\n  end() {\r\n    if (this.element === null) {\r\n      return;\r\n    }\r\n    this.unpin();\r\n    this.element = null;\r\n    this.item = null;\r\n  }\r\n}\r\n"]}